import React, { useState, useEffect } from 'react'
import { storage } from '../utils/localStorage'
import './Messages.css'

const Messages = () => {
  const [messages, setMessages] = useState({
    whatsappProspecting: 'OlÃ¡! Vi que vocÃª tem um negÃ³cio incrÃ­vel e gostaria de conversar sobre como podemos ajudar vocÃª a alcanÃ§ar resultados ainda melhores nas redes sociais. Tem um minuto para conversarmos?',
    instagramDM: 'Oi! Adorei seu perfil! Vejo que vocÃª estÃ¡ investindo bastante nas redes sociais. Que tal conversarmos sobre como potencializar ainda mais seus resultados?',
    closing: 'Que tal comeÃ§armos essa parceria agora mesmo? Estou aqui para tirar todas as suas dÃºvidas e mostrar como podemos fazer sua empresa crescer!',
    presentation: 'A Elevare Ã© uma agÃªncia especializada em marketing digital e gestÃ£o de redes sociais. Trabalhamos com estratÃ©gias personalizadas para cada cliente, sempre focando em resultados reais e crescimento sustentÃ¡vel.',
    followUp: 'OlÃ¡! Espero que esteja tudo bem! SÃ³ queria verificar se vocÃª teve a chance de avaliar nossa proposta. Estou Ã  disposiÃ§Ã£o para qualquer dÃºvida!'
  })

  useEffect(() => {
    const saved = storage.get('messages', null)
    if (saved) {
      setMessages(saved)
    }
  }, [])

  useEffect(() => {
    storage.set('messages', messages)
  }, [messages])

  const handleChange = (key, value) => {
    setMessages(prev => ({
      ...prev,
      [key]: value
    }))
  }

  const copyToClipboard = (text) => {
    navigator.clipboard.writeText(text).then(() => {
      alert('Mensagem copiada para a Ã¡rea de transferÃªncia!')
    })
  }

  const messageTypes = [
    { 
      key: 'whatsappProspecting', 
      title: 'WhatsApp - ProspecÃ§Ã£o', 
      icon: 'ğŸ’¬',
      description: 'Mensagem inicial para prospecÃ§Ã£o via WhatsApp'
    },
    { 
      key: 'instagramDM', 
      title: 'Instagram DM', 
      icon: 'ğŸ“¸',
      description: 'Mensagem para direct do Instagram'
    },
    { 
      key: 'closing', 
      title: 'Mensagem de Fechamento', 
      icon: 'âœ…',
      description: 'Script para fechar vendas'
    },
    { 
      key: 'presentation', 
      title: 'ApresentaÃ§Ã£o da Elevare', 
      icon: 'ğŸ¯',
      description: 'Texto de apresentaÃ§Ã£o da agÃªncia'
    },
    { 
      key: 'followUp', 
      title: 'Follow-up', 
      icon: 'ğŸ”„',
      description: 'Scripts de acompanhamento'
    },
  ]

  return (
    <div className="messages-page">
      <div className="page-header">
        <h1>Mensagens Prontas</h1>
        <p>Scripts e mensagens editÃ¡veis para uso rÃ¡pido</p>
      </div>

      <div className="messages-grid">
        {messageTypes.map((msgType) => (
          <div key={msgType.key} className="message-card">
            <div className="message-card-header">
              <div className="message-header-info">
                <span className="message-icon">{msgType.icon}</span>
                <div>
                  <h3 className="message-title">{msgType.title}</h3>
                  <p className="message-description">{msgType.description}</p>
                </div>
              </div>
              <button
                className="btn btn-small btn-primary"
                onClick={() => copyToClipboard(messages[msgType.key])}
              >
                ğŸ“‹ Copiar
              </button>
            </div>
            <textarea
              className="message-content editable"
              value={messages[msgType.key]}
              onChange={(e) => handleChange(msgType.key, e.target.value)}
              placeholder={`Digite aqui a mensagem para ${msgType.title.toLowerCase()}...`}
              rows="8"
            />
            <div className="message-footer">
              <span className="message-character-count">
                {messages[msgType.key].length} caracteres
              </span>
            </div>
          </div>
        ))}
      </div>
    </div>
  )
}

export default Messages
